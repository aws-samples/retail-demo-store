---
AWSTemplateFormatVersion: 2010-09-09

# Do NOT remove the RETAIL_DS prefix in the template description below!
Description: >
    RETAIL_DS: This template deploys the Retail Demo Store reference architecture and workshop notebooks.

Metadata:
  AWS::CloudFormation::Interface:
    ParameterGroups:
      - Label:
          default: "Retail Demo Store Deployment Configuration"
        Parameters:
          - ResourceBucket
          - ResourceBucketRelativePath
          - CreateElasticsearchServiceLinkedRole
      - Label:
          default: "Source Deployment Approach"
        Parameters:
          - SourceDeploymentType
      - Label:
          default: "GitHub Linked Deployment (only required for GitHub deployment approach)"
        Parameters:
          - GitHubRepo
          - GitHubBranch
          - GitHubToken
          - GitHubUser
      - Label:
          default: "Auto-Build Resources"
        Parameters:
          - PreIndexElasticsearch
          - PreCreatePersonalizeCampaign
          - PreCreatePinpointWorkshop
          - PinpointEmailFromAddress
          - PinpointEmailFromName
          - PinpointSMSLongCode
      - Label:
          default: "Use default IVS streams"
        Parameters:
          - UseDefaultIVSStreams
      - Label:
          default: "Create Location and Personalised Offers resources"
        Parameters:
          - DeployLocationServices
          - DeployPersonalizedOffersCampaign
      - Label:
          default: "Amazon Pay (optional)"
        Parameters:
          - AmazonPayStoreId
          - AmazonPayMerchantId
          - AmazonPayPublicKeyId
          - AmazonPayPrivateKey
      - Label:
          default: "Optional Integrations"
        Parameters:
          - AmplitudeApiKey
          - OptimizelySdkKey
          - IncludeSegmentDependencies
          - SegmentWriteKey
          - GoogleAnalyticsMeasurementId
    ParameterLabels:
      ResourceBucket:
        default: "Deployment Resources Staging Bucket Name"
      ResourceBucketRelativePath:
        default: "Deployment Resources Staging Bucket Relative Path (optional)"
      CreateElasticsearchServiceLinkedRole:
        default: "Create Elasticsearch Service Role?"
      SourceDeploymentType:
        default: "Deployment Type"
      GitHubRepo:
        default: "GitHub Repository Name"
      GitHubBranch:
        default: "GitHub Branch"
      GitHubToken:
        default: "GitHub Personal Access Token"
      GitHubUser:
        default: "GitHub Username"
      PreIndexElasticsearch:
        default: "Auto-Load Elasticsearch Index"
      PreCreatePersonalizeCampaign:
        default: "Auto-Build Personalize Campaigns"
      PreCreatePinpointWorkshop:
        default: "Auto-Configure Pinpoint"
      PinpointEmailFromAddress:
        default: "Reply-To email address"
      PinpointEmailFromName:
        default: "Reply-To name"
      PinpointSMSLongCode:
        default: "Pinpoint SMS long code"
      UseDefaultIVSStreams:
        default: "Use default IVS streams"
      DeployLocationServices:
        default: "Deploy Location Services resources"
      DeployPersonalizedOffersCampaign:
        default: "Deploy personalized offers and pickup notices using Location Services geofencing."
      AmplitudeApiKey:
        default: "Amplitude API Key"
      OptimizelySdkKey:
        default: "Optimizely SDK Key"
      AmazonPayStoreId:
        default: "Store ID of Amazon Pay sandbox account"
      AmazonPayMerchantId:
        default: "Merchant ID of Amazon Pay sandbox account"
      AmazonPayPublicKeyId:
        default: "Public key ID associated with Amazon Pay sandbox account"
      AmazonPayPrivateKey:
        default: "Private key associated with Amazon Pay sandbox account"
      IncludeSegmentDependencies:
        default: "Deploy Segment Resources"
      SegmentWriteKey:
        default: "Segment Write Key"
      GoogleAnalyticsMeasurementId:
        default: "Google Analytics Measurement Id"

Parameters:
  ResourceBucket:
    Type: String
    Description: >
      S3 bucket name where the Retail Demo Store deployment resources are staged (product images, nested CloudFormation templates, source code snapshot,
      notebooks, deployment Lambda code, etc).

  ResourceBucketRelativePath:
    Type: String
    Description: >
      Optional path in the Deployment Resources Staging bucket where the deployment resources are stored (e.g. path/path2/).
      Leave blank if resources are at the root of the Staging Resource Bucket. If specified, MUST end with '/'.

  CreateElasticsearchServiceLinkedRole:
    Type: String
    Description: >
      If your account already has an IAM Role named 'AWSServiceRoleForAmazonElasticsearchService', select 'No'. Otherwise, select 'Yes' and one will be created automatically.
    AllowedValues:
      - 'Yes'
      - 'No'
    Default: 'Yes'

  SourceDeploymentType:
    Type: String
    Description: >
      The Retail Demo Store deployment includes a CodePipeline configuration that will build and deploy Retail Demo Store
      microservices to ECS when a change is detected in the source repository. The source repository for CodePipeline
      can be configured to use your personal GitHub repository or CodeCommit. Use GitHub if you're actively developing
      against Retail Demo Store in your own fork. CodeCommit is useful when you just want to get up and going quickly for
      a demo or evaluation or for workshop scenarios, such as Event Engine, where you want attendees to have their own
      source repositories provisioned.
    AllowedValues:
      - 'GitHub'
      - 'CodeCommit'
    Default: 'CodeCommit'

  GitHubRepo:
    Type: String
    Description: Name of Retail Demo Store GitHub repository in your GitHub account.
    Default: retail-demo-store

  GitHubBranch:
    Type: String
    Description: Name of GitHub branch to link to this Retail Demo Store deployment.
    Default: master

  GitHubToken:
    Type: String
    Description: GitHub Personal Access Token for your GitHub account. Be sure that your token has the "repo", "repo:status", and "admin:repo_hook" permission scopes.
    NoEcho: true

  GitHubUser:
    Type: String
    Description: Your GitHub username.
    Default: aws-samples

  PreIndexElasticsearch:
    Type: String
    Description: >
      Automatically index the Retail Demo Store products in Elasticsearch. Otherwise, select 'No' if you would
      prefer to complete this process yourself by stepping through the Search workshop included in this deployment
      as a Jupyter notebook in SageMaker.
    AllowedValues:
      - 'Yes'
      - 'No'
    Default: 'No'

  PreCreatePersonalizeCampaign:
    Type: String
    Description: >
      Automatically build solutions and launch Personalize campaigns. Otherwise, select 'No' if you would
      prefer to complete this process yourself by stepping through the Personalization workshop included in this deployment
      as a Jupyter notebook in SageMaker. Note that this process is done in the background after deployment finishes
      and can take 2+ hours to complete.
    AllowedValues:
      - 'Yes'
      - 'No'
    Default: 'No'

  PreCreatePinpointWorkshop:
    Type: String
    Description: >
      Automatically configure Pinpoint with messaging templates, segments, and campaigns. Otherwise, select 'No' if you would
      prefer to complete this process yourself by stepping through the Messaging workshop included in your deployment as a Jupyter notebook
      in SageMaker. Note that this option is dependent on Auto-Build Personalize Campaigns being enabled AND completed.
    AllowedValues:
      - 'Yes'
      - 'No'
    Default: 'No'

  PinpointEmailFromAddress:
    Type: String
    Description: >
      Email address to use as Reply-To when sending emails from Pinpoint. This parameter is required when 'Auto-Configure Pinpoint'
      is set to 'Yes'.

  PinpointEmailFromName:
    Type: String
    Description: >
      Name to use with Reply-To email address when sending emails from Pinpoint. This parameter only applies when 'Auto-Configure Pinpoint'
      is set to 'Yes'.
    Default: "AWS Retail Demo Store"

  UseDefaultIVSStreams:
    Type: String
    Description: >
      Whether to create and use the default Interactive Video Service (IVS) streams hosted by AWS. If 'No', then new IVS streams will be created and streams
      created based on any videos placed in the CloudFormation resource bucket. IMPORTANT: IVS is currently only supported in the N. Virginia (us-east-1),
      Oregon (us-west-2), and Ireland (eu-west-1) regions. If deploying to an unsupported region, be sure to select 'Yes' for this parameter.
    AllowedValues:
      - 'Yes'
      - 'No'
    Default: 'Yes'

  PinpointSMSLongCode:
    Type: String
    Description: >
      A dedicated long code (i.e. a phone number) obtained for Amazon Pinpoint to send and receive messages at. Be sure to enable two way SMS for this long code using Pinpoint. Follow steps 2 and 3 in the Messaging workshop(https://github.com/aws-samples/retail-demo-store/blob/master/workshop/4-Messaging/4.1-Pinpoint.ipynb)
      to get a long code. This parameter only applies when 'Auto-Configure Pinpoint' is set to 'Yes'. Enter the number along with the country code and without any spaces or brackets. For Example: enter "+1XXXXXXXXXX" for a long code based in the United States.

  AmplitudeApiKey:
    Type: String
    Description: Amplitude API key for integrated product analytics and A/B testing results (optional).
    NoEcho: true

  OptimizelySdkKey:
    Type: String
    Description: Optimizely SDK key for experimentation (optional).
    NoEcho: true

  DeployLocationServices:
    Type: String
    Description: Deploy any Location Resources
    AllowedValues:
      - 'Yes'
      - 'No'
    Default: 'Yes'

  DeployPersonalizedOffersCampaign:
    Type: String
    Description: Deploy personalized offers and pickup notices using Location Services geofencing
    AllowedValues:
      - 'Yes'
      - 'No'
    Default: 'Yes'

  AmazonPayPublicKeyId:
    Type: String
    Description: >
      This demonstration store contains an example of signing Amazon Pay payloads for integration with an Amazon Pay sandbox.
      This parameter is the Public Key ID for the Amazon Pay sandbox account being used.
      For more information see "Amazon Pay Integration" under the README file in the amazon-pay-signing subfolder in the repository.

  AmazonPayStoreId:
    Type: String
    Description: >
      The Store ID of the Amazon Pay sandbox account being used.
      For more information see "Amazon Pay Integration" under the README file in the amazon-pay-signing subfolder in the repository.

  AmazonPayMerchantId:
    Type: String
    Description: >
      Merchant ID of the Amazon Pay sandbox account being used.
      For more information see "Amazon Pay Integration" under the README file in the amazon-pay-signing subfolder in the repository.

  AmazonPayPrivateKey:
    Type: String
    Description: >
      The private key to be used for signing Amazon Pay requests for a sandbox account.
      You will need to copy the whole contents of the .pem file into this parameter.
      For more information see "Amazon Pay Integration" under the README file in the amazon-pay-signing subfolder in the repository.
    NoEcho: true

  IncludeSegmentDependencies:
    Type: String
    Description: >
      Whether to deploy the resources required for the Segment workshops.
    AllowedValues:
      - 'Yes'
      - 'No'
    Default: 'No'

  SegmentWriteKey:
    Type: String
    Description: >
      Segment write key for real-time data collection (optional). Be sure the Segment resources are deployed (above) if you specify a write key.
    NoEcho: true

  GoogleAnalyticsMeasurementId:
    Type: String
    Description: >
      Google Analytics Measurement Identifier (optional). If specified, the Google Analytics integration in the web application is activated and
      events are sent to the data stream associated with the Measurement ID.

Conditions:
  DeploySegmentResources: !Equals
    - !Ref IncludeSegmentDependencies
    - 'Yes'

  DeployLocationStack: !Equals
    - !Ref DeployLocationServices
    - 'Yes'

  CreateAmazonPayResources: !And
    - !And
      - !Not [ !Equals [ !Ref AmazonPayPrivateKey, "" ] ]
      - !Not [ !Equals [ !Ref AmazonPayStoreId, "" ] ]
    - !And
      - !Not [ !Equals [ !Ref AmazonPayMerchantId, "" ] ]
      - !Not [ !Equals [ !Ref AmazonPayPublicKeyId, "" ] ]

Resources:
  # Base Resources
  Base:
    Type: AWS::CloudFormation::Stack
    Properties:
      TemplateURL: !Sub https://s3.amazonaws.com/${ResourceBucket}/${ResourceBucketRelativePath}cloudformation-templates/base/_template.yaml
      Parameters:
        ResourceBucket: !Ref ResourceBucket
        ResourceBucketRelativePath: !Ref ResourceBucketRelativePath
        SourceDeploymentType: !Ref SourceDeploymentType
        CreateElasticsearchServiceLinkedRole: !Ref CreateElasticsearchServiceLinkedRole
        CleanupBucketLambdaArn: !GetAtt CleanupBucket.Outputs.LambdaFunctionArn
        AmplitudeApiKey: !Ref AmplitudeApiKey
        ParentStackName: !Ref AWS::StackName
        OptimizelySdkKey: !Ref OptimizelySdkKey
        SegmentWriteKey: !Ref SegmentWriteKey
        PinpointSMSLongCode: !Ref PinpointSMSLongCode
        GoogleAnalyticsMeasurementId: !Ref GoogleAnalyticsMeasurementId
        LocationResourcePrefix: !Ref AWS::StackName
        GitHubUser: !Ref GitHubUser

  # Services Resources
  Services:
    Type: AWS::CloudFormation::Stack
    Properties:
      TemplateURL: !Sub https://s3.amazonaws.com/${ResourceBucket}/${ResourceBucketRelativePath}cloudformation-templates/services/_template.yaml
      Parameters:
        ResourceBucket: !Ref ResourceBucket
        ResourceBucketRelativePath: !Ref ResourceBucketRelativePath
        SourceDeploymentType: !Ref SourceDeploymentType
        GitHubRepo: !Ref GitHubRepo
        GitHubBranch: !Ref GitHubBranch
        GitHubToken: !Ref GitHubToken
        GitHubUser: !Ref GitHubUser
        UserPoolId: !GetAtt Base.Outputs.UserPoolId
        UserPoolClientId: !GetAtt Base.Outputs.UserPoolClientId
        IdentityPoolId: !GetAtt Base.Outputs.IdentityPoolId
        StackBucketName: !GetAtt Base.Outputs.StackBucketName
        Subnets: !GetAtt Base.Outputs.Subnets
        VpcId: !GetAtt Base.Outputs.VpcId
        ClusterName: !GetAtt Base.Outputs.ClusterName
        ServiceDiscoveryNamespace: !GetAtt Base.Outputs.ServiceDiscoveryNamespace
        EnvElasticsearchDomainEndpoint: !GetAtt Base.Outputs.ElasticsearchDomainEndpoint
        PinpointAppId: !GetAtt Base.Outputs.PinpointAppId
        ProductsTable: !GetAtt Base.Outputs.ProductsTable
        CategoriesTable: !GetAtt Base.Outputs.CategoriesTable
        ExperimentStrategyTable: !GetAtt Base.Outputs.ExperimentStrategyTable
        ParameterPersonalizeEventTrackerId: !GetAtt Base.Outputs.ParameterPersonalizeEventTrackerId
        ParameterAmplitudeApiKey: !GetAtt Base.Outputs.ParameterAmplitudeApiKey
        ParameterOptimizelySdkKey: !GetAtt Base.Outputs.ParameterOptimizelySdkKey
        CleanupBucketLambdaArn: !GetAtt CleanupBucket.Outputs.LambdaFunctionArn
        ParameterIVSVideoChannelMap: !GetAtt Base.Outputs.ParameterIVSVideoChannelMap
        WebRootUrl: !GetAtt Base.Outputs.WebUICDNURL
        UseDefaultIVSStreams: !Ref UseDefaultIVSStreams
        ImageRootUrl: !Sub
          - '${RootURL}/images/'
          - RootURL: !GetAtt Base.Outputs.WebUICDNURL
        ParentStackName: !Ref AWS::StackName

  # Web UI Pipeline
  WebUIPipeline:
    Type: AWS::CloudFormation::Stack
    Properties:
      TemplateURL: !Sub https://s3.amazonaws.com/${ResourceBucket}/${ResourceBucketRelativePath}cloudformation-templates/web-ui-pipeline.yaml
      Parameters:
        ResourceBucket: !Ref ResourceBucket
        ResourceBucketRelativePath: !Ref ResourceBucketRelativePath
        SourceDeploymentType: !Ref SourceDeploymentType
        GitHubRepo: !Ref GitHubRepo
        GitHubBranch: !Ref GitHubBranch
        GitHubToken: !Ref GitHubToken
        GitHubUser: !Ref GitHubUser
        AmazonPayMerchantId: !Ref AmazonPayMerchantId
        AmazonPayPublicKeyId: !Ref AmazonPayPublicKeyId
        AmazonPayStoreId: !Ref AmazonPayStoreId
        UserPoolId: !GetAtt Base.Outputs.UserPoolId
        UserPoolClientId: !GetAtt Base.Outputs.UserPoolClientId
        IdentityPoolId: !GetAtt Base.Outputs.IdentityPoolId
        ProductsServiceExternalUrl: !GetAtt Services.Outputs.ProductsServiceUrl
        UsersServiceExternalUrl: !GetAtt Services.Outputs.UsersServiceUrl
        CartsServiceExternalUrl: !GetAtt Services.Outputs.CartsServiceUrl
        OrdersServiceExternalUrl: !GetAtt Services.Outputs.OrdersServiceUrl
        RecommendationsServiceExternalUrl: !GetAtt Services.Outputs.RecommendationsServiceUrl
        SearchServiceExternalUrl: !GetAtt Services.Outputs.SearchServiceUrl
        VideosServiceExternalUrl: !GetAtt Services.Outputs.VideosServiceUrl
        LocationServiceExternalUrl: !GetAtt Services.Outputs.LocationServiceUrl
        OffersServiceExternalUrl: !GetAtt Services.Outputs.OffersServiceUrl
        PinpointAppId: !GetAtt Base.Outputs.PinpointAppId
        ParameterPersonalizeEventTrackerId: !GetAtt Base.Outputs.ParameterPersonalizeEventTrackerId
        LocationResourceName: !If [DeployLocationStack, !GetAtt Location.Outputs.LocationResourceName, "NotDeployed"]
        LocationNotificationEndpoint: !If [DeployLocationStack, !GetAtt Location.Outputs.LocationNotificationEndpoint, "NotDeployed"]
        ParameterAmplitudeApiKey: !GetAtt Base.Outputs.ParameterAmplitudeApiKey
        ParameterOptimizelySdkKey: !GetAtt Base.Outputs.ParameterOptimizelySdkKey
        ParameterSegmentWriteKey: !GetAtt Base.Outputs.ParameterSegmentWriteKey
        ParameterGoogleAnalyticsMeasurementId: !GetAtt Base.Outputs.ParameterGoogleAnalyticsMeasurementId
        CleanupBucketLambdaArn: !GetAtt CleanupBucket.Outputs.LambdaFunctionArn
        WebUICDN: !GetAtt Base.Outputs.WebUICDN
        WebUIBucketName: !GetAtt Base.Outputs.WebUIBucketName
        WebRootUrl: !GetAtt Base.Outputs.WebUICDNURL
        ImageRootUrl: !Sub
          - '${RootURL}/images/'
          - RootURL: !GetAtt Base.Outputs.WebUICDNURL

  # Lex personalization function
  ChatbotFunctions:
    Type: AWS::CloudFormation::Stack
    Properties:
      TemplateURL: !Sub https://s3.amazonaws.com/${ResourceBucket}/${ResourceBucketRelativePath}cloudformation-templates/lex.yaml
      Parameters:
        ResourceBucket: !Ref ResourceBucket
        ResourceBucketRelativePath: !Ref ResourceBucketRelativePath
        UsersServiceExternalUrl: !GetAtt Services.Outputs.UsersServiceUrl
        RecommendationsServiceExternalUrl: !GetAtt Services.Outputs.RecommendationsServiceUrl

  # Amazon Location Resources
  Location:
    Type: AWS::CloudFormation::Stack
    Condition: DeployLocationStack
    Properties:
      TemplateURL: !Sub https://s3.amazonaws.com/${ResourceBucket}/${ResourceBucketRelativePath}cloudformation-templates/location.yaml
      Parameters:
        ResourceBucket: !Ref ResourceBucket
        ResourceBucketRelativePath: !Ref ResourceBucketRelativePath
        UserPoolId: !GetAtt Base.Outputs.UserPoolId
        DeployDefaultGeofence: !Ref DeployPersonalizedOffersCampaign
        PinpointAppId: !GetAtt Base.Outputs.PinpointAppId
        PinpointEmailFromAddress: !Ref PinpointEmailFromAddress
        ProductsServiceExternalUrl: !GetAtt Services.Outputs.ProductsServiceUrl
        CartsServiceExternalUrl: !GetAtt Services.Outputs.CartsServiceUrl
        OrdersServiceExternalUrl: !GetAtt Services.Outputs.OrdersServiceUrl
        OffersServiceExternalUrl: !GetAtt Services.Outputs.OffersServiceUrl
        UsersServiceExternalUrl: !GetAtt Services.Outputs.UsersServiceUrl
        WebURL: !GetAtt Base.Outputs.WebUICDNURL

  AmazonPay:
    Type: AWS::CloudFormation::Stack
    Condition: CreateAmazonPayResources
    Properties:
      TemplateURL: !Sub https://s3.amazonaws.com/${ResourceBucket}/${ResourceBucketRelativePath}cloudformation-templates/amazonpay.yaml
      Parameters:
        ResourceBucket: !Ref ResourceBucket
        ResourceBucketRelativePath: !Ref ResourceBucketRelativePath
        AmazonPayPublicKeyId: !Ref AmazonPayPublicKeyId
        AmazonPayStoreId: !Ref AmazonPayStoreId
        AmazonPayPrivateKey: !Ref AmazonPayPrivateKey
        WebURL: !GetAtt Base.Outputs.WebUICDNURL

  # Deployment support
  DeploymentSupport:
    DependsOn: [Services, Base] # Delay towards end of deployment so that ES domain and DNS changes become consistent
    Type: AWS::CloudFormation::Stack
    Properties:
      TemplateURL: !Sub https://s3.amazonaws.com/${ResourceBucket}/${ResourceBucketRelativePath}cloudformation-templates/deployment-support.yaml
      Parameters:
        ResourceBucket: !Ref ResourceBucket
        ResourceBucketRelativePath: !Ref ResourceBucketRelativePath
        PreIndexElasticsearch: !Ref PreIndexElasticsearch
        PreCreatePersonalizeCampaign: !Ref PreCreatePersonalizeCampaign
        Subnet1: !GetAtt Base.Outputs.Subnet1
        Subnet2: !GetAtt Base.Outputs.Subnet2
        ElasticsearchSecurityGroupId: !GetAtt Base.Outputs.ElasticsearchSecurityGroupId
        ElasticsearchDomainArn: !GetAtt Base.Outputs.ElasticsearchDomainArn
        ElasticsearchDomainEndpoint: !GetAtt Base.Outputs.ElasticsearchDomainEndpoint
        ParameterIVSVideoChannelMap: !GetAtt Base.Outputs.ParameterIVSVideoChannelMap
        PreCreatePinpointWorkshop: !Ref PreCreatePinpointWorkshop
        Uid: !Sub ${AWS::StackName}-${AWS::Region}
        PinpointAppId: !GetAtt Base.Outputs.PinpointAppId
        PinpointPersonalizeRoleArn: !GetAtt Services.Outputs.PinpointPersonalizeRoleArn
        CustomizeRecommendationsFunctionArn: !GetAtt Services.Outputs.CustomizeRecommendationsFunctionArn
        CustomizeOffersRecommendationsFunctionArn: !GetAtt Services.Outputs.CustomizeOffersRecommendationsFunctionArn
        PinpointEmailFromAddress: !Ref PinpointEmailFromAddress
        PinpointEmailFromName: !Ref PinpointEmailFromName
        UseDefaultIVSStreams: !Ref UseDefaultIVSStreams
        DeployPersonalizedOffersCampaign: !Ref DeployPersonalizedOffersCampaign

  # Cleanup bucket function
  CleanupBucket:
    Type: AWS::CloudFormation::Stack
    Properties:
      TemplateURL: !Sub https://s3.amazonaws.com/${ResourceBucket}/${ResourceBucketRelativePath}cloudformation-templates/cleanup-bucket.yaml

  # Segment Lambda Functions and Roles
  SegmentPersonalize:
    Condition: DeploySegmentResources
    Type: AWS::CloudFormation::Stack
    Properties:
      TemplateURL: !Sub https://s3.amazonaws.com/${ResourceBucket}/${ResourceBucketRelativePath}cloudformation-templates/segment.yaml
      Parameters:
        ResourceBucket: !Ref ResourceBucket
        ResourceBucketRelativePath: !Ref ResourceBucketRelativePath

Outputs:
  UserPoolId:
    Description: Authentication Cognito User Pool Id.
    Value: !GetAtt Base.Outputs.UserPoolId

  UserPoolClientId:
    Description: Authentication Cognito User Pool Client Id.
    Value: !GetAtt Base.Outputs.UserPoolClientId

  IdentityPoolId:
    Description: Authentication Cognito Identity Pool Id.
    Value: !GetAtt Base.Outputs.IdentityPoolId

  BucketStackBucketName:
    Description: Stack Bucket Name
    Value: !GetAtt Base.Outputs.StackBucketName

  NotebookInstanceId:
    Description: Notebook Instance Id.
    Value: !GetAtt Base.Outputs.NotebookInstanceId

  VpcId:
    Description: VPC Id.
    Value: !GetAtt Base.Outputs.VpcId

  Subnets:
    Description: Service Subnets.
    Value: !GetAtt Base.Outputs.Subnets

  ClusterName:
    Description: ECS Cluster Name.
    Value: !GetAtt Base.Outputs.ClusterName

  WebURL:
    Description: Retail Demo Store Web UI URL
    Value: !GetAtt Base.Outputs.WebUICDNURL

  ElasticsearchDomainEndpoint:
    Description: Elasticsearch Endpoint
    Value: !GetAtt Base.Outputs.ElasticsearchDomainEndpoint

  ParameterIVSVideoChannelMap:
    Description: Retail Demo Store video file to IVS channel mapping parameter
    Value: !GetAtt Base.Outputs.ParameterIVSVideoChannelMap

  PinpointAppId:
    Description: Pinpoint App Id.
    Value: !GetAtt Base.Outputs.PinpointAppId
